<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Two Pointers (Same Direction - Slow/Fast) Visualizer</title>
    <style>
      :root {
        --bg: #ffffff;
        --panel: #f7f7fb;
        --card: #ffffff;
        --text: #0f172a;
        --muted: #64748b;
        --border: #e5e7eb;
        --accent: #2563eb;
        --fast: #7c3aed;
        --good: #16a34a;
        --warn: #f59e0b;
        --bad: #dc2626;
        --shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
        --radius: 14px;
        --mono:
          ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        --sans:
          ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica,
          Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }

      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: var(--sans);
        color: var(--text);
        background: transparent;
      }

      .wrap {
        max-width: 1100px;
        margin: 28px auto 48px;
        padding: 0 18px;
      }

      header {
        display: flex;
        gap: 14px;
        align-items: flex-start;
        justify-content: space-between;
        margin-bottom: 18px;
      }
      h1 {
        font-size: 20px;
        margin: 0 0 6px 0;
        letter-spacing: -0.02em;
      }
      .sub {
        margin: 0;
        color: var(--muted);
        font-size: 13px;
        line-height: 1.45;
        max-width: 64ch;
      }

      .grid {
        display: grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap: 14px;
      }

      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow: hidden;
      }

      .card .hd {
        padding: 14px 14px 10px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(180deg, #ffffff 0%, #fafaff 100%);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }
      .hd .title {
        font-weight: 650;
        font-size: 13px;
        color: #0b1226;
        letter-spacing: 0.01em;
      }
      .pill {
        font-size: 12px;
        color: var(--muted);
        border: 1px solid var(--border);
        background: #fff;
        padding: 6px 10px;
        border-radius: 999px;
        font-family: var(--mono);
      }

      .card .bd {
        padding: 14px;
      }

      /* Controls */
      .controls {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      label {
        display: block;
        font-size: 12px;
        color: var(--muted);
        margin-bottom: 6px;
      }
      input[type="text"],
      input[type="number"] {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--border);
        border-radius: 12px;
        outline: none;
        font-size: 13px;
        background: #fff;
        transition:
          border-color 0.15s ease,
          box-shadow 0.15s ease;
      }
      input[type="text"]:focus,
      input[type="number"]:focus {
        border-color: rgba(37, 99, 235, 0.45);
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.12);
      }

      .btnrow {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }
      button {
        border: 1px solid var(--border);
        background: #fff;
        padding: 9px 11px;
        border-radius: 12px;
        font-size: 13px;
        cursor: pointer;
        transition:
          transform 0.06s ease,
          border-color 0.15s ease,
          box-shadow 0.15s ease,
          background 0.15s ease;
        user-select: none;
      }
      button:hover {
        border-color: rgba(37, 99, 235, 0.35);
        box-shadow: 0 6px 18px rgba(37, 99, 235, 0.1);
      }
      button:active {
        transform: translateY(1px);
      }
      button.primary {
        border-color: rgba(37, 99, 235, 0.3);
        background: rgba(37, 99, 235, 0.06);
      }
      button.danger {
        border-color: rgba(220, 38, 38, 0.25);
        background: rgba(220, 38, 38, 0.06);
      }
      button[disabled] {
        opacity: 0.55;
        cursor: not-allowed;
        box-shadow: none !important;
      }

      .speed {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 10px;
      }
      input[type="range"] {
        width: 100%;
      }
      .speed .val {
        min-width: 92px;
        text-align: right;
        font-family: var(--mono);
        font-size: 12px;
        color: var(--muted);
      }

      /* Visualizer */
      .vizWrap {
        padding: 14px 14px 10px;
        border: 1px dashed rgba(100, 116, 139, 0.3);
        background: rgba(247, 247, 251, 0.65);
        border-radius: 14px;
      }

      .array {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        align-items: flex-end;
        padding: 12px 8px 6px;
      }

      .cell {
        width: 56px;
        height: 62px;
        border-radius: 14px;
        border: 1px solid var(--border);
        background: #fff;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 14px rgba(15, 23, 42, 0.06);
        transition:
          transform 0.18s ease,
          border-color 0.18s ease,
          box-shadow 0.18s ease,
          background 0.18s ease;
        font-family: var(--mono);
        font-size: 14px;
      }

      .cell.dim {
        opacity: 0.55;
        box-shadow: none;
      }

      .cell.activeSlow {
        border-color: rgba(37, 99, 235, 0.45);
        box-shadow: 0 10px 26px rgba(37, 99, 235, 0.14);
        transform: translateY(-2px);
      }
      .cell.activeFast {
        border-color: rgba(124, 58, 237, 0.55);
        box-shadow: 0 10px 26px rgba(124, 58, 237, 0.16);
        transform: translateY(-2px);
      }
      .cell.middle {
        border-color: rgba(22, 163, 74, 0.55);
        background: rgba(22, 163, 74, 0.06);
        box-shadow: 0 10px 26px rgba(22, 163, 74, 0.16);
      }

      .ptr {
        position: absolute;
        top: -18px;
        left: 50%;
        transform: translateX(-50%);
        display: none;
        align-items: center;
        gap: 6px;
        font-family: var(--mono);
        font-size: 12px;
        padding: 4px 7px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: #fff;
        box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
        white-space: nowrap;
      }
      .ptr .tri {
        width: 0;
        height: 0;
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-top: 8px solid currentColor;
        margin-top: 1px;
      }
      .ptr.slow {
        color: var(--accent);
      }
      .ptr.fast {
        color: var(--fast);
      }

      .cell.showSlow .ptr.slow {
        display: flex;
      }
      .cell.showFast .ptr.fast {
        display: flex;
      }

      .meta {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 10px;
        margin-top: 12px;
      }
      .kv {
        border: 1px solid var(--border);
        background: #fff;
        border-radius: 12px;
        padding: 10px 12px;
      }
      .k {
        font-size: 12px;
        color: var(--muted);
        margin-bottom: 6px;
      }
      .v {
        font-family: var(--mono);
        font-size: 13px;
        line-height: 1.2;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .statusLine {
        margin-top: 10px;
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: #fff;
        font-size: 13px;
        color: var(--text);
        line-height: 1.45;
      }
      .statusLine .tag {
        display: inline-block;
        font-family: var(--mono);
        font-size: 12px;
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid var(--border);
        margin-right: 8px;
        color: var(--muted);
      }
      .statusLine.good {
        border-color: rgba(22, 163, 74, 0.35);
        background: rgba(22, 163, 74, 0.05);
      }
      .statusLine.bad {
        border-color: rgba(220, 38, 38, 0.3);
        background: rgba(220, 38, 38, 0.05);
      }
      .statusLine.warn {
        border-color: rgba(245, 158, 11, 0.32);
        background: rgba(245, 158, 11, 0.05);
      }

      /* Log */
      .log {
        max-height: 360px;
        overflow: auto;
        border: 1px solid var(--border);
        border-radius: 14px;
        background: #fff;
        padding: 10px;
        font-family: var(--mono);
        font-size: 12px;
        line-height: 1.55;
      }
      .log .row {
        padding: 8px 8px;
        border-bottom: 1px dashed rgba(100, 116, 139, 0.25);
      }
      .log .row:last-child {
        border-bottom: none;
      }
      .log .row .t {
        color: var(--muted);
        margin-right: 8px;
      }
      .log .row .ok {
        color: var(--good);
      }
      .log .row .no {
        color: var(--bad);
      }
      .log .row .mv {
        color: var(--accent);
      }
      .log .row .mv2 {
        color: var(--fast);
      }

      .footnote {
        margin-top: 10px;
        color: var(--muted);
        font-size: 12px;
        line-height: 1.45;
      }

      @media (max-width: 920px) {
        .grid {
          grid-template-columns: 1fr;
        }
        header {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div>
          <p class="sub">
            Pattern: both pointers start at the beginning. The
            <span style="font-family: var(--mono)">Slow</span> pointer moves 1
            step at a time, while
            <span style="font-family: var(--mono)">Fast</span> moves 2 steps.
            When Fast reaches the end, Slow is at the middle.
          </p>
        </div>
        <div class="pill" id="pill">O(n) time · O(1) space</div>
      </header>

      <div class="grid">
        <!-- Left: Visual + Controls -->
        <section class="card">
          <div class="hd">
            <div class="title">Controls</div>
            <div class="pill" id="modePill">Mode: Idle</div>
          </div>
          <div class="bd">
            <div class="controls">
              <div>
                <label for="arrInput">Array (comma-separated)</label>
                <input id="arrInput" type="text" value="1, 2, 3, 4, 5, 6, 7" />
              </div>
            </div>

            <div class="btnrow">
              <button class="primary" id="btnLoad">Load / Reset</button>
              <button id="btnExample">Example (odd)</button>
              <button id="btnExampleEven">Example (even)</button>
              <button id="btnRandom">Random</button>
              <button id="btnStep" disabled>Step</button>
              <button id="btnPlay" disabled>Play</button>
              <button class="danger" id="btnClearLog">Clear Log</button>
            </div>

            <div class="speed">
              <label
                style="
                  margin: 0;
                  min-width: 60px;
                  color: var(--muted);
                  font-size: 12px;
                "
                >Speed</label
              >
              <input
                id="speedRange"
                type="range"
                min="100"
                max="1400"
                step="50"
                value="650"
              />
              <div class="val" id="speedVal">650 ms/step</div>
            </div>

            <div style="height: 12px"></div>

            <div class="vizWrap">
              <div class="array" id="array"></div>

              <div class="meta">
                <div class="kv">
                  <div class="k">Pointers</div>
                  <div class="v" id="ptrMeta">S=— · F=—</div>
                </div>
                <div class="kv">
                  <div class="k">Array Length</div>
                  <div class="v" id="lenMeta">—</div>
                </div>
                <div class="kv">
                  <div class="k">Iterations</div>
                  <div class="v" id="iterMeta">0</div>
                </div>
              </div>

              <div class="statusLine" id="statusLine">
                <span class="tag">Status</span>
                Load an array, then use
                <b>Step</b> or <b>Play</b>.
              </div>

              <div class="footnote">
                Tip: This demo finds the middle element of an array. When the
                array has even length, it returns the left-middle element
                (standard convention). The same pattern is used for linked list
                cycle detection (Floyd's tortoise and hare).
              </div>
            </div>
          </div>
        </section>

        <!-- Right: Log -->
        <aside class="card">
          <div class="hd">
            <div class="title">Execution Log</div>
            <div class="pill" id="resultPill">Result: —</div>
          </div>
          <div class="bd">
            <div class="log" id="log"></div>
          </div>
        </aside>
      </div>
    </div>

    <script>
      // ===== Utilities =====
      const $ = (id) => document.getElementById(id);
      const clamp = (n, a, b) => Math.max(a, Math.min(b, n));

      function parseArray(text) {
        const parts = text
          .split(",")
          .map((s) => s.trim())
          .filter(Boolean);
        if (parts.length === 0) return [];
        const nums = parts.map((p) => Number(p));
        if (nums.some((n) => Number.isNaN(n)))
          throw new Error("Array contains non-numeric values.");
        return nums;
      }

      function formatPointers(slow, fast) {
        if (slow == null || fast == null) return "S=— · F=—";
        return `S=${slow} · F=${fast}`;
      }

      function nowStamp() {
        const d = new Date();
        const hh = String(d.getHours()).padStart(2, "0");
        const mm = String(d.getMinutes()).padStart(2, "0");
        const ss = String(d.getSeconds()).padStart(2, "0");
        return `${hh}:${mm}:${ss}`;
      }

      // ===== State =====
      let state = {
        arr: [],
        slow: null,
        fast: null,
        iter: 0,
        done: false,
        middleIndex: null,
        autoplay: false,
        timer: null,
        lastAction: "Idle",
      };

      // ===== DOM refs =====
      const arrInput = $("arrInput");
      const arrayEl = $("array");
      const ptrMeta = $("ptrMeta");
      const lenMeta = $("lenMeta");
      const iterMeta = $("iterMeta");
      const statusLine = $("statusLine");
      const logEl = $("log");
      const modePill = $("modePill");
      const resultPill = $("resultPill");

      const btnLoad = $("btnLoad");
      const btnExample = $("btnExample");
      const btnExampleEven = $("btnExampleEven");
      const btnRandom = $("btnRandom");
      const btnStep = $("btnStep");
      const btnPlay = $("btnPlay");
      const btnClearLog = $("btnClearLog");

      const speedRange = $("speedRange");
      const speedVal = $("speedVal");

      // ===== Rendering =====
      function renderArray() {
        arrayEl.innerHTML = "";
        const { arr, slow, fast, middleIndex, done } = state;

        if (arr.length === 0) {
          const empty = document.createElement("div");
          empty.style.color = "var(--muted)";
          empty.style.fontSize = "13px";
          empty.style.padding = "14px 6px";
          empty.textContent = "No array loaded.";
          arrayEl.appendChild(empty);
          return;
        }

        arr.forEach((v, i) => {
          const cell = document.createElement("div");
          cell.className = "cell";

          // pointers
          const ptrSlow = document.createElement("div");
          ptrSlow.className = "ptr slow";
          ptrSlow.innerHTML = `<span>S</span><span class="tri"></span>`;

          const ptrFast = document.createElement("div");
          ptrFast.className = "ptr fast";
          ptrFast.innerHTML = `<span>F</span><span class="tri"></span>`;

          cell.appendChild(ptrSlow);
          cell.appendChild(ptrFast);

          const txt = document.createElement("div");
          txt.textContent = String(v);
          cell.appendChild(txt);

          // Visual states
          if (slow !== null && i === slow) cell.classList.add("activeSlow", "showSlow");
          if (fast !== null && i === fast) cell.classList.add("activeFast", "showFast");

          // If done, mark the middle
          if (middleIndex !== null && i === middleIndex) {
            cell.classList.add("middle");
          }

          arrayEl.appendChild(cell);
        });
      }

      function renderMeta() {
        const { arr, slow, fast, iter, done, middleIndex } = state;

        iterMeta.textContent = String(iter);
        lenMeta.textContent = arr.length > 0 ? `${arr.length} elements` : "—";

        if (arr.length === 0 || slow === null || fast === null) {
          ptrMeta.textContent = "S=— · F=—";
        } else {
          ptrMeta.textContent = formatPointers(slow, fast);
        }

        modePill.textContent = `Mode: ${done ? "Done" : state.autoplay ? "Playing" : "Ready"}`;

        if (middleIndex !== null) {
          resultPill.textContent = `Middle: arr[${middleIndex}] = ${arr[middleIndex]}`;
        } else {
          resultPill.textContent = "Result: —";
        }
      }

      function setStatus(kind, tag, message) {
        statusLine.className = "statusLine" + (kind ? ` ${kind}` : "");
        statusLine.innerHTML = `<span class="tag">${tag}</span>${message}`;
      }

      function logLine(html) {
        const row = document.createElement("div");
        row.className = "row";
        row.innerHTML = `<span class="t">[${nowStamp()}]</span>${html}`;
        logEl.prepend(row);
      }

      function syncButtons() {
        const ready = state.arr.length > 0 && !state.done;
        btnStep.disabled = !ready || state.autoplay;
        btnPlay.disabled = state.arr.length === 0 || state.done;

        btnPlay.textContent = state.autoplay ? "Pause" : "Play";
      }

      function renderAll() {
        renderArray();
        renderMeta();
        syncButtons();
      }

      // ===== Algorithm simulation (Slow-Fast pointers to find middle) =====
      function initRun() {
        stopAutoplay();

        try {
          const arr = parseArray(arrInput.value);

          state = {
            ...state,
            arr: arr,
            slow: arr.length ? 0 : null,
            fast: arr.length ? 0 : null,
            iter: 0,
            done: arr.length < 1,
            middleIndex: null,
            autoplay: false,
            timer: null,
            lastAction: "Initialized",
          };

          if (arr.length < 1) {
            setStatus(
              "warn",
              "Status",
              "Array must contain at least 1 element.",
            );
            logLine(
              `Loaded array (n=${arr.length}). <span class="no">Cannot run: need at least 1 element.</span>`,
            );
          } else if (arr.length === 1) {
            // Single element is its own middle
            state.done = true;
            state.middleIndex = 0;
            setStatus(
              "good",
              "Found",
              `Single element array. Middle is <b>${arr[0]}</b> at index 0.`,
            );
            logLine(`Loaded array (n=1). Middle is <b>${arr[0]}</b> at index 0.`);
          } else {
            setStatus(
              "",
              "Status",
              `Ready. Array has <b>${arr.length}</b> elements.`,
            );
            logLine(`Loaded array (n=${arr.length}).`);
          }

          renderAll();
        } catch (e) {
          setStatus("bad", "Error", e.message);
          logLine(`<span class="no">Error:</span> ${e.message}`);
          state.arr = [];
          state.done = true;
          renderAll();
        }
      }

      function step() {
        if (state.done || state.arr.length < 2) return;

        const { arr } = state;
        let { slow, fast } = state;

        // Check termination: can fast move 2 more steps?
        // If fast + 2 >= arr.length, we can't move, so current slow is the middle
        if (fast + 2 >= arr.length) {
          state.done = true;
          state.middleIndex = slow;
          setStatus(
            "good",
            "Found",
            `Fast can't move 2 more steps. Middle is <b>${arr[slow]}</b> at index ${slow}.`,
          );
          logLine(
            `Fast at ${fast}, can't move 2 steps (would exceed array). <span class="ok">Middle found:</span> arr[${slow}] = <b>${arr[slow]}</b>`,
          );
          renderAll();
          stopAutoplay();
          return;
        }

        state.iter += 1;

        // Move slow by 1
        const oldSlow = slow;
        slow = slow + 1;
        state.slow = slow;

        // Move fast by 2
        const oldFast = fast;
        fast = fast + 2;
        state.fast = fast;

        setStatus(
          "warn",
          "Move",
          `Slow: ${oldSlow} → ${slow} | Fast: ${oldFast} → ${fast}`,
        );
        logLine(
          `Iter #${state.iter}: <span class="mv">Slow ${oldSlow}→${slow}</span>, <span class="mv2">Fast ${oldFast}→${fast}</span>`,
        );

        renderAll();
      }

      function playPause() {
        if (state.arr.length < 2 || state.done) return;

        if (state.autoplay) {
          stopAutoplay();
          setStatus(
            "",
            "Status",
            "Paused. You can continue with Step or Play.",
          );
          renderAll();
          return;
        }

        state.autoplay = true;
        setStatus("", "Status", "Playing…");
        renderAll();

        const tick = () => {
          if (!state.autoplay) return;
          if (state.done) {
            stopAutoplay();
            return;
          }
          step();
          const delay = Number(speedRange.value);
          state.timer = setTimeout(tick, delay);
        };

        const delay = Number(speedRange.value);
        state.timer = setTimeout(tick, delay);
      }

      function stopAutoplay() {
        state.autoplay = false;
        if (state.timer) {
          clearTimeout(state.timer);
          state.timer = null;
        }
        syncButtons();
      }

      // ===== Helpers for demo data =====
      function loadExample() {
        arrInput.value = "1, 2, 3, 4, 5, 6, 7";
        initRun();
      }

      function loadExampleEven() {
        arrInput.value = "1, 2, 3, 4, 5, 6";
        initRun();
      }

      function loadRandom() {
        // random array with n in [5..12]
        const n = Math.floor(Math.random() * 8) + 5;
        const arr = Array.from({ length: n }, () =>
          Math.floor(Math.random() * 50) + 1,
        );

        arrInput.value = arr.join(", ");
        initRun();
      }

      // ===== Wiring =====
      btnLoad.addEventListener("click", initRun);
      btnExample.addEventListener("click", loadExample);
      btnExampleEven.addEventListener("click", loadExampleEven);
      btnRandom.addEventListener("click", loadRandom);
      btnStep.addEventListener("click", step);
      btnPlay.addEventListener("click", playPause);
      btnClearLog.addEventListener("click", () => {
        logEl.innerHTML = "";
      });

      speedRange.addEventListener("input", () => {
        speedVal.textContent = `${speedRange.value} ms/step`;
      });

      // Initial boot
      speedVal.textContent = `${speedRange.value} ms/step`;
      loadExample();
    </script>
  </body>
</html>
